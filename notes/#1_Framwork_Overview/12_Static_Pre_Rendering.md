# 12 Static Pre Rendering

## log

NextJS의 가장 좋은 기능 중 하나는, 앱에 있는 페이지들이 미리 렌더링 된다는 것이다. 즉, 정적으로 생성된다.

### CSR (Client Side Rendering)

Client Side Rendering은 요약하면 브라우저에서 유저가 보는 UI를 만드는 모든 것을 한다는 것을 의미한다. 얘를 들어 CRA(create-react-app)으로 만들어진 웹사이트에 접속해서 React가 만들어낸 다양한 요소들을 봐보자. 사용자가 보게 되는 이러한 요소들은 HTML 소스코드 안에 들어있지 않다.

이게 무슨 말이냐? 이러한 앱의 HTML 소스코드를 살펴보면 CSR의 특성 답게 body 태그 안에 하나의 div 태그 밖에 존재하지 않는다. (예를 들어 `root`이라는 id를 가진) 이걸 제와하고는 모두 자바스크립트 코드이다.

브라우저가 React.js를 다운받고 개발자가 작성한 코드를 다운받았을 때 React.js는 다른 모든 것들을 렌더링하고 사용자는 그제서야 네비게이션 바와 같은 메뉴, 이미지 그리고 텍스트 등을 비롯한 나머지를 볼 수 있게 된다.

**CSR의 단점**

아주 느린 인터넷 연결 상황을 만들고(크롬 개발자 도구 이용) CSR 웹사이트를 새로고침해보자.

첫 번째로 볼 수 있는 화면은 흰색 화면일텐데 흰색 화면인 이유는 브라우저가 자바스크립트 코드를 요청하고 있기 때문이다. 자바스크립트 코드를 통해 사용자가 볼 수 있는 UI의 모든 것을 그려내기 때문에 자바스크립트가 없다면 아무것도 보여줄 수가 없다. 앞서 말했듯이 CSR을 하고 있는 웹사이트의 HTML 코드에는 사용자에게 자바스크립트 없이 보여줄 수 있는 HTML 태그가 body 태그 내에 존재하지 않는다.

웹사이트에서 API를 사용하여 데이터를 가져오고 있는 건 문제가 되지 않는다. 사용자들은 데이터가 요청 중인 상황에 대해서는 익숙하다. 다시 말해, 로딩 중이라는 문구를 보고 기다리는 데에는 익숙하다는 뜻이다.

그러나 흰색 화면을 보는 것에는 익숙하지 않는다. 네비게이션 바의 메뉴와 같이 사용자에게 API 요청 없이도 보여줄 수 있는 UI가 존재함에도 불구하고 사용자가 보게 되는 첫 화면은 흰색 화면이라는 점이 문제다.

### SSR (Server Side Rendering)

CSR과는 다르게 SSR로 만들어진 웹사이트의 HTML 소스 코드를 살펴보면 body 태그 내에 사용자에게 보여줄 수 있는 HTML 태그가 존재하는 것을 알 수 있다. 따라서, 인터넷 속도가 상당히 느리거나 자바스크립트가 비활성화된 상태라도 사용자는 적어도 HTML은 볼 수 있게 된다.

다시 말해, API를 통해 렌더링할 데이터를 가져오는 데에는 시간이 걸릴지라도 사용자는 적어도 어떠한 HTML은 볼 수 있다는 뜻이다.

**pre-rendering**

index.js 파일을 다음과 같이 수정한 뒤 HTML 소스 코드를 확인해보자.

```javascript
import { useState } from 'react';

export default function Home() {
  const [counter, setCounter] = useState(0);

  return (
    <div>
      <h1>Hello World! {counter}</h1>
      <button onClick={() => setCounter((prev) => prev + 1)}>+</button>
    </div>
  );
}
```

HTML 소스 코드를 살펴보면 컴포넌트의 초기 상태를 활용하여 미리 렌더링되어 온 것을 확인할 수 있다. 이것을 pre-rendering이라 한다. NextJS가 React 코드를 먼저 실행하여 HTML 코드를 만들어 내고 이를 브라우저에게 보내준다. 이로 인해 자바스크립트 코드가 모두 로딩되지 않은 상태에서도 사용자에게 무언가를 보여줄 수 있게 된다.

**Hydration**

더 좋은 점은 `Hydration` 작업이 이루어 진다는 것이다. 사용자가 웹사이트에 처음 들어왔을 때 pre-rendering된 페이지를 보게 되고 자바스크립트의 로딩이 완료됐을 때 기본적으로 이미 존재하는 것들(pre-rendering된 요소들)과 연결이 되어서 일반적은 React 앱이 된다. pre-rendering된 페이지를 보여주고 자바스크립트의 로딩이 완료됐을 때 이미 존재하는 요소들과 연결시키는 과정을 `Hydration`이라고 한다.

## tips

- none

## issue

- none

## dependecy

- none
